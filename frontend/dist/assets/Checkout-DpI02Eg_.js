import{f,R as P,j as s,k as Z}from"./index-BVHp8ot4.js";/*!
 * react-paypal-js v8.9.1 (2025-09-03T21:12:12.855Z)
 * Copyright 2020-present, PayPal, Inc. All rights reserved.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * https://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var v;(function(e){e.INITIAL="initial",e.PENDING="pending",e.REJECTED="rejected",e.RESOLVED="resolved"})(v||(v={}));var b;(function(e){e.LOADING_STATUS="setLoadingStatus",e.RESET_OPTIONS="resetOptions",e.SET_BRAINTREE_INSTANCE="braintreeInstance"})(b||(b={}));var M;(function(e){e.NUMBER="number",e.CVV="cvv",e.EXPIRATION_DATE="expirationDate",e.EXPIRATION_MONTH="expirationMonth",e.EXPIRATION_YEAR="expirationYear",e.POSTAL_CODE="postalCode"})(M||(M={}));var m=function(){return m=Object.assign||function(t){for(var r,n=1,a=arguments.length;n<a;n++){r=arguments[n];for(var o in r)Object.prototype.hasOwnProperty.call(r,o)&&(t[o]=r[o])}return t},m.apply(this,arguments)};function J(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var a=0,n=Object.getOwnPropertySymbols(e);a<n.length;a++)t.indexOf(n[a])<0&&Object.prototype.propertyIsEnumerable.call(e,n[a])&&(r[n[a]]=e[n[a]]);return r}function B(e,t,r){if(r||arguments.length===2)for(var n=0,a=t.length,o;n<a;n++)(o||!(n in t))&&(o||(o=Array.prototype.slice.call(t,0,n)),o[n]=t[n]);return e.concat(o||Array.prototype.slice.call(t))}var j="data-react-paypal-script-id",x={DATA_JS_SDK_LIBRARY:"dataJsSdkLibrary",DATA_LIBRARY_VALUE:"react-paypal-js",DATA_NAMESPACE:"dataNamespace",DATA_SDK_INTEGRATION_SOURCE:"dataSdkIntegrationSource"},H="Failed to load the PayPal JS SDK script.",K="paypal",ee="usePayPalScriptReducer must be used within a PayPalScriptProvider";function te(e){return e===void 0&&(e=K),window[e]}function re(e){for(var t="",r=0;r<e.length;r++){var n=e[r].charCodeAt(0)*r;e[r+1]&&(n+=e[r+1].charCodeAt(0)*(r-1)),t+=String.fromCharCode(97+Math.abs(n)%26)}return t}function ne(e){var t=e.reactComponentName,r=e.sdkComponentKey,n=e.sdkRequestedComponents,a=n===void 0?"":n,o=e.sdkDataNamespace,c=o===void 0?K:o,u=r.charAt(0).toUpperCase().concat(r.substring(1)),l="Unable to render <".concat(t," /> because window.").concat(c,".").concat(u," is undefined."),i=typeof a=="string"?a:a.join(",");if(!i.includes(r)){var d=[i,r].filter(Boolean).join();l+=`
To fix the issue, add '`.concat(r,"' to the list of components passed to the parent PayPalScriptProvider:")+"\n`<PayPalScriptProvider options={{ components: '".concat(d,"'}}>`.")}return l}function F(e){var t=e,r=j;t[r];var n=J(t,[r+""]);return"react-paypal-js-".concat(re(JSON.stringify(n)))}function ae(e){var t=self.document.querySelector("script[".concat(j,'="').concat(e,'"]'));t?.parentNode&&t.parentNode.removeChild(t)}function oe(e,t){var r,n;switch(t.type){case b.LOADING_STATUS:return typeof t.value=="object"?m(m({},e),{loadingStatus:t.value.state,loadingStatusErrorMessage:t.value.message}):m(m({},e),{loadingStatus:t.value});case b.RESET_OPTIONS:return ae(e.options[j]),m(m({},e),{loadingStatus:v.PENDING,options:m(m((r={},r[x.DATA_SDK_INTEGRATION_SOURCE]=x.DATA_LIBRARY_VALUE,r),t.value),(n={},n[j]="".concat(F(t.value)),n))});case b.SET_BRAINTREE_INSTANCE:return m(m({},e),{braintreePayPalCheckoutInstance:t.value});default:return e}}var X=f.createContext(null);function se(e){if(typeof e?.dispatch=="function"&&e.dispatch.length!==0)return e;throw new Error(ee)}function ie(){var e=se(f.useContext(X)),t=m(m({},e),{isInitial:e.loadingStatus===v.INITIAL,isPending:e.loadingStatus===v.PENDING,isResolved:e.loadingStatus===v.RESOLVED,isRejected:e.loadingStatus===v.REJECTED});return[t,e.dispatch]}f.createContext({});function ce(e){var t=f.useRef(new Proxy({},{get:function(r,n,a){return typeof r[n]=="function"?function(){for(var o=[],c=0;c<arguments.length;c++)o[c]=arguments[c];return r[n].apply(r,o)}:Reflect.get(r,n,a)}}));return t.current=Object.assign(t.current,e),t.current}var T=function(e){var t,r=e.className,n=r===void 0?"":r,a=e.disabled,o=a===void 0?!1:a,c=e.children,u=e.forceReRender,l=u===void 0?[]:u,i=J(e,["className","disabled","children","forceReRender"]),d=o?{opacity:.38}:{},h="".concat(n," ").concat(o?"paypal-buttons-disabled":"").trim(),y=f.useRef(null),g=f.useRef(null),S=ce(i),p=ie()[0],E=p.isResolved,I=p.options,_=f.useState(null),A=_[0],$=_[1],D=f.useState(!0),W=D[0],z=D[1],Q=f.useState(null),R=Q[1];function N(){g.current!==null&&g.current.close().catch(function(){})}return!((t=g.current)===null||t===void 0)&&t.updateProps&&g.current.updateProps({message:i.message}),f.useEffect(function(){if(E===!1)return N;var O=te(I.dataNamespace);if(O===void 0||O.Buttons===void 0)return R(function(){throw new Error(ne({reactComponentName:T.displayName,sdkComponentKey:"buttons",sdkRequestedComponents:I.components,sdkDataNamespace:I[x.DATA_NAMESPACE]}))}),N;var Y=function(w,k){$(k),typeof i.onInit=="function"&&i.onInit(w,k)};try{g.current=O.Buttons(m(m({},S),{onInit:Y}))}catch(w){return R(function(){throw new Error("Failed to render <PayPalButtons /> component. Failed to initialize:  ".concat(w))})}return g.current.isEligible()===!1?(z(!1),N):(y.current&&g.current.render(y.current).catch(function(w){y.current===null||y.current.children.length===0||R(function(){throw new Error("Failed to render <PayPalButtons /> component. ".concat(w))})}),N)},B(B([E],l,!0),[i.fundingSource],!1)),f.useEffect(function(){A!==null&&(o===!0?A.disable().catch(function(){}):A.enable().catch(function(){}))},[o,A]),P.createElement(P.Fragment,null,W?P.createElement("div",{ref:y,style:d,className:h}):c)};T.displayName="PayPalButtons";function le(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var a=0,n=Object.getOwnPropertySymbols(e);a<n.length;a++)t.indexOf(n[a])<0&&Object.prototype.propertyIsEnumerable.call(e,n[a])&&(r[n[a]]=e[n[a]]);return r}function ue(e,t){var r=document.querySelector('script[src="'.concat(e,'"]'));if(r===null)return null;var n=G(e,t),a=r.cloneNode();if(delete a.dataset.uidAuto,Object.keys(a.dataset).length!==Object.keys(n.dataset).length)return null;var o=!0;return Object.keys(a.dataset).forEach(function(c){a.dataset[c]!==n.dataset[c]&&(o=!1)}),o?r:null}function de(e){var t=e.url,r=e.attributes,n=e.onSuccess,a=e.onError,o=G(t,r);o.onerror=a,o.onload=n,document.head.insertBefore(o,document.head.firstElementChild)}function pe(e){var t=e.sdkBaseUrl,r=e.environment,n=le(e,["sdkBaseUrl","environment"]),a=t||he(r),o=n,c=Object.keys(o).filter(function(i){return typeof o[i]<"u"&&o[i]!==null&&o[i]!==""}).reduce(function(i,d){var h=o[d].toString();return d=fe(d),d.substring(0,4)==="data"||d==="crossorigin"?i.attributes[d]=h:i.queryParams[d]=h,i},{queryParams:{},attributes:{}}),u=c.queryParams,l=c.attributes;return u["merchant-id"]&&u["merchant-id"].indexOf(",")!==-1&&(l["data-merchant-id"]=u["merchant-id"],u["merchant-id"]="*"),{url:"".concat(a,"?").concat(me(u)),attributes:l}}function fe(e){var t=function(r,n){return(n?"-":"")+r.toLowerCase()};return e.replace(/[A-Z]+(?![a-z])|[A-Z]/g,t)}function me(e){var t="";return Object.keys(e).forEach(function(r){t.length!==0&&(t+="&"),t+=r+"="+e[r]}),t}function he(e){return e==="sandbox"?"https://www.sandbox.paypal.com/sdk/js":"https://www.paypal.com/sdk/js"}function G(e,t){t===void 0&&(t={});var r=document.createElement("script");return r.src=e,Object.keys(t).forEach(function(n){r.setAttribute(n,t[n]),n==="data-csp-nonce"&&r.setAttribute("nonce",t["data-csp-nonce"])}),r}function ye(e,t){if(t===void 0&&(t=Promise),V(e,t),typeof document>"u")return t.resolve(null);var r=pe(e),n=r.url,a=r.attributes,o=a["data-namespace"]||"paypal",c=U(o);return a["data-js-sdk-library"]||(a["data-js-sdk-library"]="paypal-js"),ue(n,a)&&c?t.resolve(c):ve({url:n,attributes:a},t).then(function(){var u=U(o);if(u)return u;throw new Error("The window.".concat(o," global variable is not available."))})}function ve(e,t){t===void 0&&(t=Promise),V(e,t);var r=e.url,n=e.attributes;if(typeof r!="string"||r.length===0)throw new Error("Invalid url.");if(typeof n<"u"&&typeof n!="object")throw new Error("Expected attributes to be an object.");return new t(function(a,o){if(typeof document>"u")return a();de({url:r,attributes:n,onSuccess:function(){return a()},onError:function(){var c=new Error('The script "'.concat(r,'" failed to load. Check the HTTP status code and response body in DevTools to learn more.'));return o(c)}})})}function U(e){return window[e]}function V(e,t){if(typeof e!="object"||e===null)throw new Error("Expected an options object.");var r=e.environment;if(r&&r!=="production"&&r!=="sandbox")throw new Error('The `environment` option must be either "production" or "sandbox".');if(typeof t<"u"&&typeof t!="function")throw new Error("Expected PromisePonyfill to be a function.")}var ge=function(e){var t,r=e.options,n=r===void 0?{clientId:"test"}:r,a=e.children,o=e.deferLoading,c=o===void 0?!1:o,u=f.useReducer(oe,{options:m(m({},n),(t={},t[x.DATA_JS_SDK_LIBRARY]=x.DATA_LIBRARY_VALUE,t[x.DATA_SDK_INTEGRATION_SOURCE]=x.DATA_LIBRARY_VALUE,t[j]="".concat(F(n)),t)),loadingStatus:c?v.INITIAL:v.PENDING}),l=u[0],i=u[1];return f.useEffect(function(){if(c===!1&&l.loadingStatus===v.INITIAL)return i({type:b.LOADING_STATUS,value:v.PENDING});if(l.loadingStatus===v.PENDING){var d=!0;return ye(l.options).then(function(){d&&i({type:b.LOADING_STATUS,value:v.RESOLVED})}).catch(function(h){console.error("".concat(H," ").concat(h)),d&&i({type:b.LOADING_STATUS,value:{state:v.REJECTED,message:String(h)}})}),function(){d=!1}}},[l.options,c,l.loadingStatus]),P.createElement(X.Provider,{value:m(m({},l),{dispatch:i})},a)};function L(){}f.createContext({cardFieldsForm:null,fields:{},registerField:L,unregisterField:L});const C="https://mellissa-statesmanly-pseudoevangelically.ngrok-free.dev";function be({total:e,name:t,email:r,phone:n,address:a,cartItems:o,onSuccess:c,onFailure:u}){return s.jsx(ge,{options:{clientId:"ATar9PV--m8pqHJ22oSvJpgXgecNKU_nF9OHKg3Ogg9Jg15C4XA1tk3JTpUoHBbQFfIwFXS5bh4-eNg0",currency:"USD",intent:"capture",vault:!0},children:s.jsx(T,{fundingSource:"paypal",style:{layout:"vertical",color:"gold",shape:"rect",tagline:!1},onApprove:async l=>{try{const i=sessionStorage.getItem("checkout_order_id");if(!i)throw new Error("Missing local order id");const d=await fetch(`${C}/api/payments/paypal/capture-order`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({orderID:l.orderID,localOrderId:i})}),h=await d.json();if(!d.ok)throw new Error(h.message||"Capture failed");c?.(i)}catch(i){console.error("captureOrder failed:",i),u?.("PayPal capture failed")}},onError:l=>{console.error("PayPal Checkout error:",l),u?.("PayPal checkout failed")},createOrder:async()=>{try{const l=await fetch(`${C}/api/payments/paypal/create-order`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({total:e,name:t,email:r,phone:n,address:a,cartItems:o})}),i=await l.json();if(!l.ok||!i.orderID||!i.localOrderId)throw new Error(i.message||"Could not create PayPal order");return sessionStorage.setItem("checkout_order_id",i.localOrderId),i.orderID}catch(l){throw console.error("createOrder failed:",l),u?.("Failed to create PayPal order"),l}}})})}const q="https://mellissa-statesmanly-pseudoevangelically.ngrok-free.dev";function xe({total:e,name:t,email:r,phone:n,address:a,cartItems:o,onSuccess:c,onFailure:u}){const[l,i]=f.useState(!1),d=async()=>{try{i(!0);const h=await fetch(`${q}/api/payments/mpesa/initiate`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({total:e,name:t,email:r,phone:n,address:a,cartItems:o})}),y=await h.json();if(!h.ok||!y.localOrderId)throw new Error(y.message||"M-Pesa initiation failed");sessionStorage.setItem("checkout_order_id",y.localOrderId),c?.(y.localOrderId)}catch(h){u?.(h?.message||"Failed to initiate M-Pesa payment")}finally{i(!1)}};return s.jsx("button",{type:"button",onClick:d,disabled:l,className:"group flex w-full items-center justify-between rounded-md border border-green-700 bg-[#43B02A] px-4 py-3 text-white shadow-sm transition hover:bg-[#3A9A24] disabled:cursor-not-allowed disabled:opacity-60",children:s.jsxs("span",{className:"flex items-center gap-3",children:[s.jsx("span",{className:"inline-flex h-8 w-8 items-center justify-center rounded-full bg-white/15 text-sm font-bold",children:"M"}),s.jsxs("span",{className:"text-left",children:[s.jsx("span",{className:"block text-sm leading-none",children:"M-Pesa"}),s.jsx("span",{className:"block text-xs text-white/90",children:l?"Sending STK Push...":"Pay with M-Pesa"})]})]})})}function Ee(){const[e,t]=f.useState(""),[r,n]=f.useState(""),[a,o]=f.useState(""),[c,u]=f.useState(""),[l,i]=f.useState("paypal"),[d,h]=f.useState(""),{cartItems:y,clearCart:g}=Z(),S=f.useMemo(()=>y.reduce((p,E)=>p+E.price*E.quantity,0),[y]);return s.jsx("div",{className:"bg-gray-50 min-h-screen py-10",children:s.jsxs("div",{className:"max-w-4xl mx-auto bg-white p-8 rounded-xl shadow-lg",children:[s.jsx("h1",{className:"text-2xl font-bold mb-6",children:"Checkout"}),s.jsxs("div",{className:"mb-6",children:[s.jsx("h2",{className:"text-lg font-semibold mb-2",children:"Your Cart"}),s.jsx("ul",{className:"divide-y divide-gray-200",children:y.map(p=>s.jsxs("li",{className:"flex justify-between py-2 text-gray-700",children:[s.jsxs("span",{children:[p.name," (x",p.quantity,")"]}),s.jsxs("span",{children:["$",(p.price*p.quantity).toFixed(2)]})]},p.id))}),s.jsxs("div",{className:"flex justify-between mt-4 font-semibold text-lg",children:[s.jsx("span",{children:"Total:"}),s.jsxs("span",{children:["$",S.toFixed(2)]})]})]}),s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium mb-1",children:"Full Name"}),s.jsx("input",{type:"text",className:"w-full border rounded-lg px-3 py-2 focus:ring focus:ring-blue-300",value:e,onChange:p=>t(p.target.value),placeholder:"John Doe"})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium mb-1",children:"Email"}),s.jsx("input",{type:"email",className:"w-full border rounded-lg px-3 py-2 focus:ring focus:ring-blue-300",value:r,onChange:p=>n(p.target.value),placeholder:"you@example.com"})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium mb-1",children:"Phone"}),s.jsx("input",{type:"tel",className:"w-full border rounded-lg px-3 py-2 focus:ring focus:ring-blue-300",value:a,onChange:p=>o(p.target.value),placeholder:"07XXXXXXXX"})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium mb-1",children:"Address"}),s.jsx("textarea",{className:"w-full border rounded-lg px-3 py-2 focus:ring focus:ring-blue-300",value:c,onChange:p=>u(p.target.value),placeholder:"123 Coffee Street, Nairobi"})]}),s.jsx("div",{children:s.jsx("p",{className:"mb-2 text-sm font-medium text-gray-700",children:"Select Payment Method"})}),s.jsxs("div",{className:"grid grid-cols-2 gap-3 pt-2",children:[s.jsx("button",{type:"button",className:`rounded-md border px-4 py-2 text-sm font-medium ${l==="paypal"?"border-blue-600 bg-blue-50 text-blue-700":"bg-white text-gray-700"}`,onClick:()=>i("paypal"),children:"PayPal Method"}),s.jsx("button",{type:"button",className:`rounded-md border px-4 py-2 text-sm font-medium ${l==="mpesa"?"border-green-600 bg-green-50 text-green-700":"bg-white text-gray-700"}`,onClick:()=>i("mpesa"),children:"M-Pesa Method"})]}),d?s.jsx("p",{className:"text-sm text-gray-700 rounded bg-gray-100 px-3 py-2",children:d}):null,s.jsx("div",{className:"mt-3",children:l==="paypal"?s.jsx(be,{total:S,name:e,email:r,phone:a,address:c,cartItems:y,onSuccess:()=>{g(),h("Payment successful.")},onFailure:p=>h(p)}):s.jsx(xe,{total:S,name:e,email:r,phone:a,address:c,cartItems:y,onSuccess:()=>h("M-Pesa request sent"),onFailure:p=>h(p)})})]})]})})}export{Ee as default};
